import os
import pandas as pd
from nba_api.stats.static import teams
from pathlib import Path

# Setup data directory path - go up one level from notebooks to project root
BASE_DIR = Path(os.getcwd()).parent
DATA_DIR = BASE_DIR / 'data' / 'game3'
os.makedirs(DATA_DIR, exist_ok=True)

,GAME_ID,TEAM_ID,TEAM_ABBREVIATION,TEAM_CITY,PLAYER_ID,PLAYER_NAME,NICKNAME,START_POSITION,COMMENT,MIN,FGM,FGA,FG_PCT,FG3M,FG3A,FG3_PCT,FTM,FTA,FT_PCT,OREB,DREB,REB,AST,STL,BLK,TO,PF,PTS,PLUS_MINUS
0,0042400403,1610612760,OKC,Oklahoma City,1629652,Luguentz Dort,Luguentz,F,,35.000000:46,4.0,8.0,0.5,4.0,5.0,0.8,0.0,0.0,0.0,1.0,3.0,4.0,0.0,0.0,0.0,0.0,3.0,12.0,1.0
1,0042400403,1610612760,OKC,Oklahoma City,1631114,Jalen Williams,Jalen,F,,36.000000:27,9.0,18.0,0.5,1.0,2.0,0.5,7.0,11.0,0.636,2.0,4.0,6.0,3.0,1.0,0.0,4.0,3.0,26.0,-9.0
2,0042400403,1610612760,OKC,Oklahoma City,1631096,Chet Holmgren,Chet,C,,34.000000:42,6.0,15.0,0.4,0.0,6.0,0.0,8.0,9.0,0.889,1.0,9.0,10.0,2.0,1.0,0.0,1.0,0.0,20.0,1.0
3,0042400403,1610612760,OKC,Oklahoma City,1641717,Cason Wallace,Cason,G,,24.000000:20,3.0,5.0,0.6,0.0,1.0,0.0,1.0,2.0,0.5,1.0,3.0,4.0,1.0,1.0,1.0,2.0,2.0,7.0,-10.0
4,0042400403,1610612760,OKC,Oklahoma City,1628983,Shai Gilgeous-Alexander,Shai,G,,42.000000:02,9.0,20.0,0.45,1.0,3.0,0.333,5.0,6.0,0.833,2.0,6.0,8.0,4.0,0.0,3.0,6.0,2.0,24.0,-3.0
5,0042400403,1610612760,OKC,Oklahoma City,1627936,Alex Caruso,Alex,,,32.000000:14,2.0,5.0,0.4,2.0,2.0,1.0,2.0,2.0,1.0,1.0,4.0,5.0,4.0,2.0,0.0,1.0,3.0,8.0,-15.0
6,0042400403,1610612760,OKC,Oklahoma City,1628392,Isaiah Hartenstein,Isaiah,,,18.000000:13,2.0,3.0,0.667,0.0,0.0,0.0,0.0,0.0,0.0,0.0,3.0,3.0,0.0,1.0,0.0,2.0,2.0,4.0,-4.0
7,0042400403,1610612760,OKC,Oklahoma City,1630598,Aaron Wiggins,Aaron,,,9.000000:39,0.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,2.0,2.0,0.0,0.0,1.0,3.0,0.0,-5.0
8,0042400403,1610612760,OKC,Oklahoma City,1630198,Isaiah Joe,Isaiah,,,4.000000:13,2.0,2.0,1.0,2.0,2.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,6.0,0.0
9,0042400403,1610612760,OKC,Oklahoma City,1631119,Jaylin Williams,Jaylin,,,0.000000:20,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0
10,0042400403,1610612760,OKC,Oklahoma City,1629026,Kenrich Williams,Kenrich,,,2.000000:04,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-2.0
11,0042400403,1610612760,OKC,Oklahoma City,1631172,Ousmane Dieng,Ousmane,,DNP - Coach's Decision,,,,,,,,,,,,,,,,,,,,
12,0042400403,1610612760,OKC,Oklahoma City,1641794,Dillon Jones,Dillon,,DNP - Coach's Decision,,,,,,,,,,,,,,,,,,,,
13,0042400403,1610612760,OKC,Oklahoma City,1642349,Ajay Mitchell,Ajay,,DNP - Coach's Decision,,,,,,,,,,,,,,,,,,,,
14,0042400403,1610612754,IND,Indiana,1630174,Aaron Nesmith,Aaron,F,,22.000000:06,3.0,5.0,0.6,1.0,2.0,0.5,0.0,0.0,0.0,1.0,1.0,2.0,0.0,1.0,1.0,0.0,6.0,7.0,1.0
15,0042400403,1610612754,IND,Indiana,1627783,Pascal Siakam,Pascal,F,,31.000000:58,8.0,14.0,0.571,0.0,2.0,0.0,5.0,6.0,0.833,0.0,6.0,6.0,4.0,2.0,1.0,0.0,3.0,21.0,8.0
16,0042400403,1610612754,IND,Indiana,1626167,Myles Turner,Myles,C,,29.000000:44,3.0,11.0,0.273,1.0,4.0,0.25,2.0,2.0,1.0,0.0,2.0,2.0,1.0,1.0,5.0,2.0,2.0,9.0,-8.0
17,0042400403,1610612754,IND,Indiana,1629614,Andrew Nembhard,Andrew,G,,33.000000:25,3.0,5.0,0.6,1.0,2.0,0.5,1.0,2.0,0.5,1.0,3.0,4.0,1.0,0.0,0.0,3.0,5.0,8.0,3.0
18,0042400403,1610612754,IND,Indiana,1630169,Tyrese Haliburton,Tyrese,G,,36.000000:20,9.0,17.0,0.529,4.0,8.0,0.5,0.0,0.0,0.0,1.0,8.0,9.0,11.0,2.0,1.0,4.0,1.0,22.0,1.0
19,0042400403,1610612754,IND,Indiana,1630167,Obi Toppin,Obi,,,27.000000:48,4.0,8.0,0.5,0.0,3.0,0.0,0.0,0.0,0.0,1.0,5.0,6.0,1.0,0.0,2.0,1.0,3.0,8.0,18.0
20,0042400403,1610612754,IND,Indiana,1641767,Ben Sheppard,Ben,,,18.000000:05,2.0,5.0,0.4,0.0,2.0,0.0,0.0,0.0,0.0,1.0,1.0,2.0,0.0,2.0,0.0,0.0,1.0,4.0,-2.0
21,0042400403,1610612754,IND,Indiana,204456,T.J. McConnell,T.J.,,,15.000000:06,3.0,8.0,0.375,0.0,1.0,0.0,4.0,4.0,1.0,1.0,0.0,1.0,5.0,5.0,0.0,2.0,1.0,10.0,12.0
22,0042400403,1610612754,IND,Indiana,1628418,Thomas Bryant,Thomas,,,3.000000:04,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,0.0,-4.0
23,0042400403,1610612754,IND,Indiana,1631097,Bennedict Mathurin,Bennedict,,,22.000000:24,9.0,12.0,0.75,2.0,3.0,0.667,7.0,8.0,0.875,1.0,3.0,4.0,1.0,0.0,1.0,1.0,0.0,27.0,16.0
24,0042400403,1610612754,IND,Indiana,1628396,Tony Bradley,Tony,,DNP - Coach's Decision,,,,,,,,,,,,,,,,,,,,
25,0042400403,1610612754,IND,Indiana,1642277,Johnny Furphy,Johnny,,DNP - Coach's Decision,,,,,,,,,,,,,,,,,,,,
26,0042400403,1610612754,IND,Indiana,1630543,Isaiah Jackson,Isaiah,,DND - Injury/Illness,,,,,,,,,,,,,,,,,,,,
27,0042400403,1610612754,IND,Indiana,201949,James Johnson,James,,DNP - Coach's Decision,,,,,,,,,,,,,,,,,,,,
28,0042400403,1610612754,IND,Indiana,1641716,Jarace Walker,Jarace,,DND - Injury/Illness,,,,,,,,,,,,,,,,,,,,
